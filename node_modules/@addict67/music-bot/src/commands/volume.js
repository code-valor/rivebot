'use strict';

const VolumeEmbed = require('../embeds/volume-embed');
const ErrorEmbed = require('../embeds/error-embed');

/**
 * Volume command.
 */
const volume = {
	name: 'volume',
	description: 'Müzik sesini değiştirir',
	execute(message, arg, musicBot) {
		const serverQueue = musicBot.queue.get(message.guild.id);

		if (!serverQueue) {
			return message.channel.send(new ErrorEmbed('Şarkı oynatmıyorsun ki sesi kısayım aq'));
		}

		const nbr = parseInt(arg, 10);
		if (!isNaN(nbr) && (nbr >= 0 && nbr <= 100)) {
			message.channel.send(new VolumeEmbed(serverQueue.volume * 100, nbr));
			serverQueue.volume = nbr / 100;

			const {dispatcher} = serverQueue.connection;
			if (dispatcher) {
				dispatcher.setVolumeLogarithmic(serverQueue.volume);
			}
		} else {
			message.channel.send(new ErrorEmbed('Ses seviyesi `0` ile `100` arasında olmalıdır!'));
		}
	}
};

/**
 * Module exports.
 */
module.exports = volume;
